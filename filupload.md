## 파일 업로드 설계 시 고려할 사항

- 동일 이름으로 파일이 업로드 되었을 때 기존 파일이 사라지는 문제
  - 현재 시간을 밀리세컨드까지 구분해서 파일 이름을 생성해서 저장
  - UUID를 사용해서 중복 발생율이 거의 없는 문자열로 이름을 저장
- 한 폴더의 너무 많은 이미지가 들어가 있어서 DiskIO가 성능이 안나오는 문제
  - 년/월/일 단위로 폴더를 생성해서 파일을 저장한다.  
- 이미지 파일의 경우 원본 파일의 용량이 큰 경우는 섬네일 이미지를 생성해야 하는 문제
  - 업로드된 파일이 이미지 종류의 파일인지 확인
  - 이미지 파일일 경우 섬네일 이미지 생성 및 서버에 저장
    - 서버에 저장후 JSON 응답으로 업로드된 파일 이름, 원본 파일 이름, 파일이 저장된 경로, 이미지인지 아닌지에 대한 정보를 보내줘야함
    - JSON 응답을 통해 서버에 다시 GET 요청으로 섬네일이나 파일 이미지를 보여줘야함
  - input type="file"을 사용할 경우 JS를 사용하여 업로드 후에 업로드 부분을 초기화 시켜줘야함
- 첨부파일 공격에 대비하기 위한 업로드 파일의 확장자 제한
  - JS에서 정규식으로 한번 걸러주고, 서버에서도 저장할 때 한번 더 검증하도록 한다.
  
- 첨부 파일을 삭제할 경우
  - 이미지 파일의 경우 섬네일까지 삭제되어야 한다는 점
  - 파일을 삭제한 후에는 브라우저에서도 섬네일이나 파일 아이콘이 삭제되도록 처리해야 한다는 점
  - 비정상적으로 브라우저 종료 시 업로드 된 파일의 처리 -> Spring Batch를 사용해서 최종적인 결과와 서버의 업로드된 파일 목록을 확인해서
  삭제 처리함
  
- 첨부 파일을 수정할 경우
  - 주기적으로 파일과 데이터베이스를 비교하여 파일의 일관성을 유지해야 한다.
  
- 이미지 객체를 설계할 경우
  - 이미지의 원본 이름
  - 이미지의 저장된 이름
  - 이미지 타입
  - 이미지의 저장 경로